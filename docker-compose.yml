services:
  openclaw:
    container_name: openclaw-agentic
    build:
      context: .
      args:
        EXTRA_APT_PACKAGES: ""  # Add apt packages here, e.g. "python3 python3-pip"
    ports:
      - "${OPENCLAW_BIND_HOST:-127.0.0.1}:18789:18789"
    volumes:
      - ./data:/root/.openclaw        # Persistent config + conversations
      - ./workspace:/root/openclaw        # Workspace + skills
    environment:
      - OPENCLAW_GATEWAY_TOKEN=${OPENCLAW_GATEWAY_TOKEN}
      - DISCORD_BOT_TOKEN=${DISCORD_BOT_TOKEN}
      - OLLAMA_BASE_URL=${OLLAMA_BASE_URL}
      - OLLAMA_MODEL=${OLLAMA_MODEL}
      - OLLAMA_API_KEY=ollama-local
    restart: unless-stopped

  # The Browser Service (Remote CDP Endpoint)
  browser:
    container_name: openclaw-browser
    image: browserless/chrome:latest
    ports:
      - "3000:3000"
    environment:
      - PUID=1000
      - PGID=1000
      - TZ=Europe/Brussels
      - CHROME_CLI=--remote-debugging-port=9222 --no-sandbox --disable-gpu --disable-software-rasterizer
    volumes:
      - ./browser-data:/config # Persists logins/cookies
    shm_size: 2g
